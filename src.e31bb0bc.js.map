{"version":3,"sources":["ab_testing/api/analytics.js","ab_testing/constants.js","ab_testing/api/storage.js","ab_testing/library/mapVariations.js","ab_testing/library/setRandomVariation.js","ab_testing/library/showVariation.js","ab_testing/index.js","index.js","../node_modules/parcel-bundler/src/builtins/bundle-url.js","../node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["Analytics","instance","Object","freeze","node","dataset","variation","track","metric","test","console","log","pathname","analyticsClient","CONSTANTS","Variation","Control","Test","Performed","Storage","page","localStorage","setItem","_getPathKey","getItem","path","storageClient","mapVariations","variationNodes","document","querySelectorAll","forEach","style","display","addEventListener","e","preventDefault","stopPropagation","getMetricPerformed","setMetricPerformed","trackEvent","control","push","setRandomVariation","tests","keys","weight","nodeVariation","hasWeight","getVariation","rollResult","Math","random","getWeightRoll","getDefaultRoll","setVariation","showVariation","variationForNode","mountAbTesting","getPageView","window","location","setPageView","trackPageview","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","split","Date","now","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","setTimeout","links","i","length","module"],"mappings":"AQAA,ACAA,IDAIgE,ACAAY,MAAM,GDAG,ACAAC,GDAG,IAAhB,ACAoB,CAAC,cAAD,CAApB;;ADCA,ACCA,AFFA,SCCSZ,ACCAa,UAAT,CAAoBC,IAApB,EAA0B,CDD1B,GAA8B;AAC5B,ACCA,MDDI,ACCAC,CDDChB,MCCM,GDDX,ACCce,EDDE,ECCE,CAACE,SAAL,EAAd;ADAEjB,ADFJ,ICEIA,SAAS,GAAGE,YAAY,EAAxB;AACD,ACADc,EAAAA,OAAO,CAACE,MAAR,GAAiB,YAAY;AAC3BH,ARLJ,AMGA,IEEIA,ARLEjE,IQKE,CAACqE,IRLM,EQKX,CRLc;AOMhB,ACAC,APNH,ADCEpE,AKDF,AHAA,ACAA,ACAA,EJCEA,CQGA,MDEOiD,EPLE,EAAE,KOKX,MPNgB;AOOjB,APLChD,EAAAA,OAAO,EAAE,SAFO;AQOhBgE,ARJA/D,AKFF,AHAA,ACAA,ACCO,EIKL+D,ARJA/D,IAAI,EAAE,CQIC,AJLOuC,CIKN4B,IAAR,ARPgB,GQODL,IAAI,CAACK,AJLf,CAAuBxD,GIKb,CAAUyD,KAAV,CAAgB,GAAhB,CJLV,CIK+B,CAArB,AJL6B,IIKH,GAA1B,GAAgCC,IAAI,CAACC,GAAL,EAA/C;ADEF,ACDER,ARJA7D,AIDA,EIKA6D,ARJA7D,IQII,AJLE0B,CIKD4C,EDCEtB,EPLE,AIDE,EJCA,CIDGhE,GIKd,CAAgBuF,EJLI,CGMtB,AHNuB5C,GGMC,CHNR,CAAYjB,IIK1B,CAA6BoD,OAA7B,EAAsCD,AJLxB,CAAd,GIK0C,CAACW,WAA3C;ADEA,ACDD,ARTiB,AKElB,AHAA,ACCO,ACEL9C,CJLF,CIKEA,KAAK,CAACb,CDFQY,MCEd,CAAc,UAAClC,CDFV,CAA4BmB,ECEnB,EAAU,UDFnB,EAA4C;AIQjD,AJPA,ACEE,MGKE,AJPEgB,ECEEa,GDFG,GAAGvD,MAAM,CAAC2C,GCEG,CDFV,CAAYjB,CCECF,aDFb,CAAd,SCEyCuB,YAAd,CAA2BxC,IAA3B,CAAzB;AGMA,ACDJ,AHRA,AHCO,ACELmC,EAAAA,EKKE+C,ATXE3F,GIMC,CAAC+B,CDFQJ,CKQN,IAAIwC,ACDA,CLLZ,CAAc,CKKC,EDCP,EAAN,ACDJ,CNPO,CAAuBvC,GCEbnB,IAAD,EAAU,KDFnB,EAAuC;AKS3C,ARZD,AGIAoB,ACEED,ACCAA,EFHFC,CKMA,CAEE,AJNAD,ACCAA,MFHM,CKQCwC,ALRAtC,GKQP,EAAY,EJNE,ACCA,CDDCrB,ACCAA,ILPH,AIME,ACCA,CDDd,ACCA,CDDqBgC,ACCAgB,EFHvB,CAA0B,ICExB,CAA6B1B,OAA7B,CDFF,ACEuC,ACCrC,EFHuCA,AEGAA,OFHzC,AEGE,CFH+C,ACET3B,ACCS,IDDV,EAAU,IDFCA,AEGAA,IFHD,AEGA,EFHU,AEGA;AGMzD,ACFJ,ATXgB,AMGhB,AHEIA,ACEE,ACCAA,IHPAe,ACIFf,EEGEA,EGKEiE,ALRA,CMMCuB,ANNA5D,CEGC,CAACA,GFHP,CKQW,ALRAC,CEGT,CAAWA,CGKC,ACFlB,CDEmB,ECFE,CNNjB,EKQoBmC,AHLlB,CFHmB,CCEgChE,CIM9B,AHLA,CGKCkE,EJNiC,CDFzD,ACE0DjE,ACCxD,EGKY,EAAiBkE,GJN7B,EIMY,CAAuB,+DAAvB,CAAd;ACDF,APVA,ACKE,ACAE,ACED,KAFD,CIKEoB,ILLQ7C,MKKZ,ALLI,EKKY,GPVF,GCK+B1C,IAAI,CAACC,ICAtCyC,GDAV,GCAE;AIOF,ACDA,ATZA,AECY,AIEhB,AHGI,ACAE,ACGH,GAND,KGUMuB,ALPI/D,ECAqByC,KIO7B,EAAa,ALPb,MCAE,WDAMzC,MCAUA,GDAlB,MCAE;AIQA,ACDH,ATZC,AGKA,ACAE,ACIL,QLTON,AGKeO,ECAyBE,GIQnC+D,ALRT,CCAE,GJLW,CAACvE,KQaK,CAACoE,ERbhB,IGKe9D,CKQQ,AJRiBE,CIQhB,CAAD,CAAR,CAAjB,ALRF,ACAE,GJLgCT,SAAlC,EAA6C;AQc5C,ARbC,AEAF,AIGG,AHCH,ACEE,QDFwBQ,CGDdkD,CFGNpD,GJNGN,CGIT,KCEE,GJNgB,CAACC,AMGhB,GAA0B,KNH3B,AGIwBO,MAA1B;AKUD,ACDDmF,ATZG,AEAD,AIGF,AHAE,ACGE,EKMJA,IHREjE,EJJIP,ACG8BV,ECG1BuC,EKMA,ANTR,GMSW6C,APZA,CAAC5F,GEMK,GAAG,EFNhB,COYiB,CAAC,GHRR0D,AHDoBlD,ACGPqC,IDH3B,ECGoB,CFNY3B,EOYE,EHRlC,AFEsC,CEFZyC,EJJ1B,EAAyC,EIIT,CAACC,GFE/B,KEFwB,CAAgBjD,QAA1C,MAAwDE,qBAAUI,SADpE,EAEE;AGQA,APZE,AIKFQ,QGOIoE,KAAK,APZA3E,GOYGU,IPZI,CAAC5B,GOYG,CAAC6B,EHPPgC,EJLZ,SIKF,CAA0BF,EGOd,CAA0B,GHPN,CAACC,QAAP,CAAgBjD,QAA1C,GGOY,CAAZ;ADEF,ARdEV,AECC,ACGD,ACGE,IJPFA,IGII,CKUC,CRdC,AIOAwB,CJPCvB,CQcT,GLVaI,EHJX,CAAc,EGIV,EHJJ,GGIqB,QCGD0C,GDHpB,EAAkC,OCG5B,CAA2BxC,IAA3B,MAAqC,IAAzC,EAA+C;AIQpD,ACFG,ATZAT,AMKAa,AHDET,ACGE,IJPJJ,EGIEI,GMQG,CNRC,CAAC8B,EMQE6D,ATZA,CSYC,ATZA9F,GSYG,CAAb,EAAgB8F,CAAC,CTZjB,ESYoBD,CTZC,EGInB,CAAsBvF,CMQC,ATZzB,CSY0ByF,CHPVjC,EHDd,EAA6B,CMQ/B,EAAkCgC,CAAC,EAAnC,EAAuC,CHPvC,CAA8BnC,AHDEzB,CAAD,EAAO,GGCF,CAAC0B,QAAP,CAAgBjD,QAA9C;AGQE,ATZH,AEACV,AIKD,AHDKiC,ACGD,GEPL,CJAEjC,ICIIiC,CGCC,AHDA,CMQCyC,APZA,ACIAxC,CDJCjC,KOYK,CAACqE,APZb,CAAc,IAAd,ECII,GMQE,CAAkBsB,KAAK,CAACC,CAAD,CAAL,CAASX,IAA3B,MAAqCR,MAAM,CAACV,YAAP,EAAzC,EAAgE;ADGtE,ACFQY,APZJ3D,AIKAT,AHDIyB,IDJJhB,AIKAT,IGOIoE,ANRA3C,CKUCqC,ALVA,CAACnC,CDJC,AIKA,CJLCpC,AIKAU,GAAR,GGOc,CDElB,ACFmBmF,CDECrB,ANdhB,GMcJ,ANduB,COYC,CDEC,ACFAsB,ANRjB,CMQgB,CAAN,APZd,COYI,eHNkBnC,MAAM,CAACC,QAAP,CAAgBjD,QADtC;AEUF,ACFK,APZJ,AIOA,AFAG,SIOG,CAAC,AJPEsC,KIOGuB,GAAN,EAAWC,AJPE,GAAGvB,IIOhB,AJPoB,CIOD,AJPEC,MAAL,KAAgB,GAAnC,kEIOG,EAAqG,IAArG,IAA6G,GAApH;AACD,ACFI,ANTG,ACKF9C,MAAAA,MDLMoB,GCKG,GAAGsB,SAAS,GACjBK,KDNgBf,QCMH,CAACY,SDNZ,CAAiC1C,ACMtB,EAAasC,IDNxB,ECMW,EAAqBC,EDNajC,WCMlC,CADI,GAEjBwC,MDPyDpC,QCO3C,CDPhB,ACOiBgC,EDPqD,QCOtD,CAFlB;AEAJ,AHJQxC,MGIFkB,IHJElB,CHLR,MGKe,CAACC,EGII,CHJZ,EGIe,EAAvB,MNTWP,IAAX,EAAiB,qBGMqBI,MAD9B;AKYVmE,ACFIgB,ATdA,AMSF,AHFQ,ACKJjE,IKEFiE,GDEG,CAACzB,MCFM,GAAG,GDEjB,CCFI,EDEmBD,GRhBwB7D,GIY3BmD,CJZ+B,CAAClD,KMSpCuB,ENTZ,GQgBJ,AJJM,CAA2BnB,IAA3B,EAAiCH,EEHrC,OFGI;AIKNqE,ACFG,ATfC,AMUF,AHFO,GMFgB,EASpB,EDEE,ACXkB,CDWjBH,ACXN,ETNUlE,CEAV,OMiBF,CRjBI,EQiBiBkE,UAArB,CNjBcpD,IFAFd,AEAV,EAAkB,OFAhB,CMUiBsB,cAAnB;AGMD,AThBG,AECAP,AIUF,AFEIX,MFZFW,AEYEX,IJbiBH,GIaV,CAACI,CJbV,EIaE,CFZU,CAACW,OAAb,CAAqB,KFDFf,AECOgB,IIUdK,CNXZ,MECqB,CAAiBR,IAAjB,CAArB,CIUF,CJV+CN,cEaDL,IAD1C,GFZqDS,SAAvD,cEagEZ,SAD9D;AJbF,AEED,AIUF,AHHOoB,ACOH,KApBD,KJI0BlB,MAA1B,eGSkB+B,EHTQ/B,MAA1B,UGSI,CAAiCA,MAAjC;AMSRyF,ATlBI,AIiBD,GAtBD,GKuBI,CAACtB,GTlB+BlE,ISkBtC,ATlBI,GSkBamF,SAAjB,KTlBsCnF,IAAlC;AACAC,AGSIG,ACQP,MJjBGH,OAAO,CAACC,GAAR,kBGSoB6B,UAAhB,CAA2BpC,IAA3B,WHRkCE,SADtC,sBAC2DC,KAD3D,uBAC6EC,MAD7E,qBAC8FC,IAD9F;AAGD,AGOI,OAXD,IDIJ,qBAAYW,IAAZ,EAAkB;AAChB,ACOC,ACQL,SAASiC,IFfEhC,SEeX,CAAuB6B,EFfA,CAAC1B,OAAb,AEeX,CFfgC,CEeGsB,IFfEvB,EEerC,EAA2CwB,OFfX,CAAiB3B,IAAjB,CAArB,AEeX,CFfI,CEesD;AFdvD,AEeD,MAAId,SAAS,GAAGyC,aAAhB;ADPE,QAAI,GHRN,IGQanB,cAAc,CAACnB,IHRdG,AGQa,CAArB,KAAgC,EHRtC,EAAwB,OGQtB,EAAiD;AHPjDF,AGQEkB,ACOJ,MJfElB,AGQEkB,ACOAsB,OJfK,CAACvC,EIeI,CJfZ,EIeemC,CDPC,CAACrC,IAAD,ACOlB,CDPI,CCOqB,EDPE,wBHReG,QAAxC;AACD,AGQK6B,ACOJnC,IAAAA,IDPImC,GDRN,EEeW,EDPE,CCQTM,CDRW,EADY,UCSV,IFhBJtC,CEgBSK,GFhBtB,EAAmBR,SAAnB,EAA8B,KEgBEW,IAA5B,GAAmCH,qBAAUE,OAA7C,GAAuDF,qBAAUG,IADnE;AFdAI,ACQIZ,ACQL,MFhBCY,ECQIZ,IAAI,EAAE,IDRE,CAACa,OAAb,CAAqBb,IAArB,EAA2BH,SAA3B;AACD,ACK0B,OAAvB;AAID,ACQH,SAAOA,SAAP;AACD;ADRGsB,IAAAA,ODTF,OCSgB,CAACnB,IAAD,CAAd,CAAqBH,QDTVG,CCSX,EAAgCiC,CDTlC,EAAmB,CCSjB,CAAqCtC,IAArC;AHTJ,AECI,ACSD,ACSH,GDpCE,CHiBIS,KImBGyC,IFlBEjC,MFDU,GAAG,CImBxB,CAAwB6B,CFlBD,CFDKlD,AECJwB,OAAb,CAAqBf,AEkBhC,CJnBwB,CImBY,CJnBpC,CECW,CAAP;AACD,ACSF,ACSC,SAAOyC,UAAU,GAAG,EAAb,GAAkBpC,qBAAUE,OAA5B,GAAsCF,qBAAUG,IAAvD;AACD;;WFjBC,4BAAmBT,MAAnB,EAA2B;AACzBa,MAAAA,YAAY,CAACC,OAAb,CAAqBd,MAArB,EAA6BM,qBAAUI,SAAvC;AACD;;;WAED,4BAAmBV,MAAnB,EAA2B;AACzB,aAAOa,YAAY,CAACG,OAAb,CAAqBhB,MAArB,CAAP;AACD;;;WAED,qBAAYiB,IAAZ,EAAkB;AAChB,oCAAuBA,IAAvB;AACD;;;;;;AAEH,IAAMC,aAAa,GAAG,IAAIP,OAAJ,EAAtB","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["class Analytics {\n  constructor() {\n    // Singleton\n    if (Analytics.instance instanceof Analytics) {\n      return Analytics.instance;\n    }\n    Object.freeze(this);\n    Analytics.instance = this;\n  }\n\n  trackEvent(node) {\n    const { variation, track, metric, test } = node.dataset;\n    console.log(\n      `--> DEBUG: TrackEvent Variation: ${variation}, Track: ${track}, Metric: ${metric}, Test: ${test}`\n    );\n  }\n\n  trackPageview(pathname) {\n    console.log(`--> DEBUG: Pageview URL: ${pathname}`);\n  }\n}\n\nconst analyticsClient = new Analytics();\n\nexport { analyticsClient };\n","const CONSTANTS = {\n  Variation: 'variation',\n  Control: 'control',\n  Test: 'test',\n  Performed: 'performed',\n};\n\nexport { CONSTANTS };\n","import { CONSTANTS } from '../constants';\n\nclass Storage {\n  constructor() {\n    // Singleton\n    if (Storage.instance instanceof Storage) {\n      return Storage.instance;\n    }\n    Object.freeze(this);\n    Storage.instance = this;\n  }\n  setPageView(page) {\n    localStorage.setItem(this._getPathKey(page), CONSTANTS.Performed);\n  }\n\n  getPageView(page) {\n    return localStorage.getItem(this._getPathKey(page));\n  }\n\n  setVariation(test, variation) {\n    localStorage.setItem(test, variation);\n  }\n  getVariation(test) {\n    return localStorage.getItem(test);\n  }\n\n  setMetricPerformed(metric) {\n    localStorage.setItem(metric, CONSTANTS.Performed);\n  }\n\n  getMetricPerformed(metric) {\n    return localStorage.getItem(metric);\n  }\n\n  _getPathKey(path) {\n    return `visited-path-${path}`;\n  }\n}\nconst storageClient = new Storage();\n\nexport { storageClient };\n","import { analyticsClient } from '../api/analytics';\nimport { storageClient } from '../api/storage';\nimport { CONSTANTS } from '../constants';\n\nexport function mapVariations(variationNodes) {\n  document.querySelectorAll('[data-test]').forEach((node) => {\n    node.style.display = 'none';\n\n    const { variation, track, metric, test } = node.dataset;\n\n    if (typeof track !== 'undefined') {\n      node.addEventListener(track, (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (storageClient.getMetricPerformed(metric) === CONSTANTS.Performed) {\n          console.log(\n            `--> DEBUG: TRACK:Metric \"${metric}\" already performed by user during this session.`\n          );\n          return;\n        }\n        storageClient.setMetricPerformed(metric);\n        analyticsClient.trackEvent(node);\n      });\n    }\n\n    if (typeof variationNodes[test] === 'undefined') {\n      variationNodes[test] = {\n        control: [],\n        test: [],\n      };\n    }\n    variationNodes[test][variation].push(node);\n  });\n}\n","import { storageClient } from '../api/storage';\nimport { CONSTANTS } from '../constants';\n\nexport function setRandomVariation(variationNodes) {\n  const tests = Object.keys(variationNodes);\n\n  tests.forEach((test) => {\n    variationNodes[test].control.forEach((node) => {\n      const { weight, variation: nodeVariation, test } = node.dataset;\n\n      let variation;\n      const hasWeight = typeof weight !== 'undefined';\n\n      if (storageClient.getVariation(test) !== null) {\n        return;\n      }\n\n      const rollResult = Math.random() * 100;\n\n      variation = hasWeight\n        ? getWeightRoll(rollResult, weight, nodeVariation)\n        : getDefaultRoll(rollResult);\n\n      storageClient.setVariation(test, variation);\n      console.log(\n        `--> DEBUG: Variation selected: Test: ${test}, Variation: ${variation}`\n      );\n    });\n  });\n}\n\nfunction getWeightRoll(rollResult, weight, nodeVariation) {\n  let variation = nodeVariation;\n  if (rollResult > weight) {\n    variation =\n      nodeVariation === CONSTANTS.Test ? CONSTANTS.Control : CONSTANTS.Test;\n  }\n\n  return variation;\n}\n\nfunction getDefaultRoll(rollResult) {\n  return rollResult > 50 ? CONSTANTS.Control : CONSTANTS.Test;\n}\n","import { storageClient } from '../api/storage';\n\nexport function showVariation(variationNodes) {\n  const tests = Object.keys(variationNodes);\n\n  tests.forEach((test) => {\n    const variationForNode = storageClient.getVariation(test);\n\n    variationNodes[test][variationForNode].forEach((node) => {\n      node.style.display = null;\n    });\n  });\n}\n","import { analyticsClient } from './api/analytics';\nimport { storageClient } from './api/storage';\nimport { CONSTANTS } from './constants';\nimport { mapVariations } from './library/mapVariations';\nimport { setRandomVariation } from './library/setRandomVariation';\nimport { showVariation } from './library/showVariation';\n\nexport function mountAbTesting() {\n  if (\n    storageClient.getPageView(window.location.pathname) !== CONSTANTS.Performed\n  ) {\n    storageClient.setPageView(window.location.pathname);\n    analyticsClient.trackPageview(window.location.pathname);\n  } else {\n    console.log(\n      `--> DEBUG: TRACK:${window.location.pathname} already performed by user during this session.`\n    );\n  }\n\n  const variationNodes = {};\n  mapVariations(variationNodes);\n  setRandomVariation(variationNodes);\n  showVariation(variationNodes);\n}\n","import './styles.scss';\nimport { mountAbTesting } from './ab_testing';\n\nmountAbTesting();\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)?\\/[^/]+(?:\\?.*)?$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}